<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arbre G√©n√©alogique - Tinang Joseph</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); color: #333; line-height: 1.6; min-height: 100vh; }
        
        .header { background: linear-gradient(135deg, #2d5016, #3d6b1f); color: white; padding: 40px 20px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .header h1 { font-size: 36px; margin-bottom: 10px; font-weight: 700; }
        .header p { font-size: 16px; opacity: 0.9; }
        
        .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        
        .nav { background: white; display: flex; gap: 15px; padding: 20px; margin-bottom: 30px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); flex-wrap: wrap; }
        .nav-btn { padding: 12px 24px; border: none; background: #f0f0f0; cursor: pointer; border-radius: 8px; font-weight: 600; transition: all 0.3s; font-size: 14px; }
        .nav-btn:hover { background: #e0e0e0; transform: translateY(-2px); }
        .nav-btn.active { background: linear-gradient(135deg, #2d5016, #3d6b1f); color: white; }
        
        .tab { display: none; }
        .tab.active { display: block; }
        
        .search { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .search input { width: 100%; padding: 12px 20px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: border-color 0.3s; }
        .search input:focus { outline: none; border-color: #2d5016; }
        
        .cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.2); }
        .card-header { border-bottom: 2px solid #f0f0f0; padding-bottom: 12px; margin-bottom: 12px; }
        .card-title { font-size: 18px; font-weight: 700; color: #2d5016; margin-bottom: 4px; }
        .card-subtitle { font-size: 14px; color: #666; }
        .card-body { font-size: 14px; }
        .card-item { margin: 8px 0; }
        .card-item strong { color: #555; }
        
        .tree { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow-x: auto; }
        .generation { margin: 40px 0; text-align: center; }
        .generation-title { font-size: 14px; color: #666; margin-bottom: 20px; text-transform: uppercase; font-weight: 600; letter-spacing: 1px; }
        .generation-members { display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; align-items: center; }
        .tree-node { background: white; border: 3px solid #2d5016; border-radius: 12px; padding: 15px 20px; min-width: 150px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .tree-node:hover { transform: scale(1.05); box-shadow: 0 6px 12px rgba(0,0,0,0.2); border-color: #d97706; }
        .tree-node.patriarch { border-color: #d97706; border-width: 4px; background: linear-gradient(135deg, #fff9e6, #ffffff); }
        .tree-node.heir { border-color: #059669; border-width: 3px; background: linear-gradient(135deg, #e6fff9, #ffffff); }
        .node-name { font-weight: 700; font-size: 15px; color: #2d5016; margin-bottom: 4px; }
        .node-dates { font-size: 12px; color: #666; }
        .node-role { font-size: 11px; color: #d97706; margin-top: 4px; font-weight: 600; }
        
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px); }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .modal-content { background: white; border-radius: 16px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .modal-header { background: linear-gradient(135deg, #2d5016, #3d6b1f); color: white; padding: 20px; border-radius: 16px 16px 0 0; display: flex; justify-content: space-between; align-items: center; }
        .modal-title { font-size: 22px; font-weight: 700; }
        .modal-close { background: none; border: none; color: white; font-size: 28px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: background 0.3s; }
        .modal-close:hover { background: rgba(255,255,255,0.2); }
        .modal-body { padding: 30px; }
        .modal-section { margin-bottom: 24px; }
        .modal-section-title { font-size: 16px; font-weight: 700; color: #2d5016; margin-bottom: 12px; border-bottom: 2px solid #f0f0f0; padding-bottom: 8px; }
        .modal-item { margin: 8px 0; font-size: 14px; }
        .modal-item strong { color: #555; }
        
        .footer { background: #2d5016; color: white; text-align: center; padding: 30px 20px; margin-top: 60px; }
        .footer p { margin: 8px 0; }
        
        .loading { text-align: center; padding: 40px; color: #666; font-size: 16px; }
        .error { background: #fee; color: #c00; padding: 20px; border-radius: 8px; margin: 20px; text-align: center; }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 28px; }
            .cards { grid-template-columns: 1fr; }
            .nav { flex-direction: column; }
            .nav-btn { width: 100%; }
            .tree { padding: 20px; }
            .generation-members { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="header">
    <h1>üå≥ Arbre G√©n√©alogique Familial</h1>
    <p>Ta'a Fieu Tagni Tinang Joseph ‚Ä¢ Batchingou ‚Ä¢ Foumbot ‚Ä¢ Balengou</p>
</div>

<div class="container">
    <div class="nav">
        <button class="nav-btn active" onclick="switchTab('overview')">üìã Aper√ßu</button>
        <button class="nav-btn" onclick="switchTab('generations')">üå≥ G√©n√©rations</button>
        <button class="nav-btn" onclick="switchTab('people')">üë• Personnes</button>
        <button class="nav-btn" onclick="switchTab('locations')">üìç Localit√©s</button>
    </div>

    <div id="overview" class="tab active">
        <div class="search">
            <input type="text" id="searchOverview" placeholder="üîç Chercher une personne..." onkeyup="filterCards('overview')">
        </div>
        <div class="cards" id="overviewCards"></div>
    </div>

    <div id="generations" class="tab">
        <div class="tree" id="generationsTree">
            <div class="loading">Chargement de l'arbre g√©n√©alogique...</div>
        </div>
    </div>

    <div id="people" class="tab">
        <div class="search">
            <input type="text" id="searchPeople" placeholder="üîç Chercher une personne..." onkeyup="filterCards('people')">
        </div>
        <div class="cards" id="peopleCards"></div>
    </div>

    <div id="locations" class="tab">
        <div class="cards" id="locationsCards"></div>
    </div>
</div>

<div id="personModal" class="modal" onclick="if(event.target.id==='personModal') closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <div class="modal-title" id="modalTitle">Titre</div>
            <button class="modal-close" onclick="closeModal()">‚úï</button>
        </div>
        <div class="modal-body" id="modalBody">Contenu</div>
    </div>
</div>

<div class="footer">
    <p>G√©n√©alogie familiale ‚Ä¢ 1770-2025 ‚Ä¢ 7 g√©n√©rations ‚Ä¢ 100+ membres</p>
    <p style="margin-top: 12px; font-size: 13px;">"La famille est la source de vie et de bonheur"</p>
</div>

<script>
// Global data
let familyData = null;

// Load JSON data
async function loadData() {
    console.log('Script d√©marr√©');
    console.log('Chargement du fichier family-data-complete.json...');
    try {
        const response = await fetch('family-data-complete.json');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        familyData = await response.json();
        console.log('‚úì Donn√©es charg√©es:', familyData);
        console.log('Nombre de familles:', familyData.families.length);
        console.log('Nombre de g√©n√©rations:', familyData.generations.length);
        renderAll();
    } catch (error) {
        console.error('Erreur lors du chargement:', error);
        document.getElementById('overviewCards').innerHTML = '<div class="error">Erreur: Impossible de charger family-data-complete.json. Assurez-vous que le fichier est dans le m√™me dossier que genealogy.html.</div>';
        document.getElementById('generationsTree').innerHTML = '<div class="error">Erreur de chargement des donn√©es.</div>';
    }
}

// Switch tabs
function switchTab(tabName) {
    console.log('Affichage onglet:', tabName);
    document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
}

// Render all sections
function renderAll() {
    console.log('renderAll() appel√©');
    renderOverview();
    renderGenerations();
    renderPeople();
    renderLocations();
}

// Render Overview (3 main people)
function renderOverview() {
    console.log('renderOverview()');
    const container = document.getElementById('overviewCards');
    if (!familyData || !familyData.families) return;
    
    const featured = familyData.families.slice(0, 5);
    container.innerHTML = featured.map(person => `
        <div class="card" onclick="showPerson('${person.id}')">
            <div class="card-header">
                <div class="card-title">${person.name}</div>
                <div class="card-subtitle">${person.role || person.generation}</div>
            </div>
            <div class="card-body">
                ${person.dates ? `<div class="card-item"><strong>Dates:</strong> ${person.dates}</div>` : ''}
                ${person.born ? `<div class="card-item"><strong>N√©:</strong> ${person.born}</div>` : ''}
                ${person.birthPlace ? `<div class="card-item"><strong>Lieu:</strong> ${person.birthPlace}</div>` : ''}
                ${person.children ? `<div class="card-item"><strong>Enfants:</strong> ${person.children}</div>` : ''}
            </div>
        </div>
    `).join('');
}

// Render Generations (Visual tree)
function renderGenerations() {
    console.log('renderGenerations()');
    const container = document.getElementById('generationsTree');
    if (!familyData || !familyData.generations) return;
    
    let html = '';
    familyData.generations.forEach(gen => {
        html += `<div class="generation">
            <div class="generation-title">G√©n√©ration ${gen.level} (${gen.year})</div>
            <div class="generation-members">`;
        
        gen.members.forEach(member => {
            const classes = ['tree-node'];
            if (member.id === 'tinang-joseph' || member.highlight) classes.push('patriarch');
            if (member.id === 'poueme-emmanuel' || member.role === 'H√©ritier') classes.push('heir');
            
            const clickHandler = member.id ? `onclick="showPerson('${member.id}')"` : '';
            
            html += `
                <div class="${classes.join(' ')}" ${clickHandler}>
                    <div class="node-name">${member.name}</div>
                    ${member.dates ? `<div class="node-dates">${member.dates}</div>` : ''}
                    ${member.role ? `<div class="node-role">${member.role}</div>` : ''}
                    ${member.status ? `<div class="node-role">${member.status}</div>` : ''}
                    ${member.location ? `<div class="node-dates">${member.location}</div>` : ''}
                </div>
            `;
        });
        
        html += `</div></div>`;
    });
    
    container.innerHTML = html;
    console.log('Arbre g√©n√©alogique rendu');
}

// Render People (All family members)
function renderPeople() {
    console.log('renderPeople()');
    const container = document.getElementById('peopleCards');
    if (!familyData || !familyData.families) return;
    
    container.innerHTML = familyData.families.map(person => `
        <div class="card person-card" onclick="showPerson('${person.id}')">
            <div class="card-header">
                <div class="card-title">${person.name}</div>
                <div class="card-subtitle">${person.role || person.generation}</div>
            </div>
            <div class="card-body">
                ${person.dates ? `<div class="card-item"><strong>Dates:</strong> ${person.dates}</div>` : ''}
                ${person.born ? `<div class="card-item"><strong>N√©:</strong> ${person.born}</div>` : ''}
                ${person.birthPlace ? `<div class="card-item"><strong>Naissance:</strong> ${person.birthPlace}</div>` : ''}
                ${person.residence ? `<div class="card-item"><strong>R√©sidence:</strong> ${person.residence}</div>` : ''}
                ${person.occupation ? `<div class="card-item"><strong>Profession:</strong> ${person.occupation}</div>` : ''}
            </div>
        </div>
    `).join('');
}

// Render Locations
function renderLocations() {
    console.log('renderLocations()');
    const container = document.getElementById('locationsCards');
    if (!familyData || !familyData.locations) return;
    
    container.innerHTML = familyData.locations.map(location => `
        <div class="card">
            <div class="card-header">
                <div class="card-title">${location.name}</div>
                <div class="card-subtitle">${location.region || ''}</div>
            </div>
            <div class="card-body">
                ${location.quarter ? `<div class="card-item"><strong>Quartier:</strong> ${location.quarter}</div>` : ''}
                ${location.established ? `<div class="card-item"><strong>√âtabli:</strong> ${location.established}</div>` : ''}
                ${location.founder ? `<div class="card-item"><strong>Fondateur:</strong> ${location.founder}</div>` : ''}
                ${location.residents ? `<div class="card-item"><strong>R√©sidents:</strong> ${location.residents}</div>` : ''}
                ${location.significance ? `<div class="card-item"><strong>Importance:</strong> ${location.significance}</div>` : ''}
            </div>
        </div>
    `).join('');
}

// Show person modal
function showPerson(personId) {
    console.log('Affichage personne:', personId);
    if (!familyData || !familyData.families) return;
    
    const person = familyData.families.find(p => p.id === personId);
    if (!person) {
        console.error('Personne non trouv√©e:', personId);
        return;
    }
    
    document.getElementById('modalTitle').textContent = person.name;
    
    let html = '';
    
    // Informations g√©n√©rales
    html += '<div class="modal-section">';
    html += '<div class="modal-section-title">‚ÑπÔ∏è Informations G√©n√©rales</div>';
    if (person.ndap) html += `<div class="modal-item"><strong>Ndap:</strong> ${person.ndap}</div>`;
    if (person.dates) html += `<div class="modal-item"><strong>Dates:</strong> ${person.dates}</div>`;
    if (person.born) html += `<div class="modal-item"><strong>N√©:</strong> ${person.born}</div>`;
    if (person.lifespan) html += `<div class="modal-item"><strong>Dur√©e de vie:</strong> ${person.lifespan}</div>`;
    if (person.generation) html += `<div class="modal-item"><strong>G√©n√©ration:</strong> ${person.generation}</div>`;
    if (person.birthPlace) html += `<div class="modal-item"><strong>Lieu de naissance:</strong> ${person.birthPlace}</div>`;
    if (person.deathPlace) html += `<div class="modal-item"><strong>Lieu de d√©c√®s:</strong> ${person.deathPlace}</div>`;
    if (person.burialPlace) html += `<div class="modal-item"><strong>Lieu d'inhumation:</strong> ${person.burialPlace}</div>`;
    if (person.residence) html += `<div class="modal-item"><strong>R√©sidence:</strong> ${person.residence}</div>`;
    html += '</div>';
    
    // Famille
    if (person.father || person.mother || person.spouse || person.spouses || person.children) {
        html += '<div class="modal-section">';
        html += '<div class="modal-section-title">üíç Famille</div>';
        if (person.father) html += `<div class="modal-item"><strong>P√®re:</strong> ${person.father}</div>`;
        if (person.mother) html += `<div class="modal-item"><strong>M√®re:</strong> ${person.mother}</div>`;
        if (person.spouse) html += `<div class="modal-item"><strong>√âpouse:</strong> ${person.spouse}</div>`;
        if (person.spouses && person.spouses.length) {
            html += '<div class="modal-item"><strong>√âpouses:</strong></div>';
            person.spouses.forEach(sp => {
                html += `<div class="modal-item" style="margin-left: 20px;">‚Ä¢ ${sp.name}${sp.dates ? ' (' + sp.dates + ')' : ''}${sp.place ? ' - ' + sp.place : ''}</div>`;
                if (sp.children && sp.children.length) {
                    html += `<div class="modal-item" style="margin-left: 40px; font-size: 12px;">Enfants: ${sp.children.join(', ')}</div>`;
                }
            });
        }
        if (person.children) html += `<div class="modal-item"><strong>Nombre d'enfants:</strong> ${person.children}</div>`;
        if (person.childrenNames && person.childrenNames.length) {
            html += `<div class="modal-item"><strong>Noms des enfants:</strong> ${person.childrenNames.join(', ')}</div>`;
        }
        html += '</div>';
    }
    
    // Profession & Titres
    if (person.occupation || person.titles || person.workPlace || person.activities) {
        html += '<div class="modal-section">';
        html += '<div class="modal-section-title">üíº Profession & Titres</div>';
        if (person.occupation) html += `<div class="modal-item"><strong>Profession:</strong> ${person.occupation}</div>`;
        if (person.workPlace) html += `<div class="modal-item"><strong>Lieu de travail:</strong> ${person.workPlace}</div>`;
        if (person.titles && person.titles.length) {
            html += '<div class="modal-item"><strong>Titres:</strong></div>';
            person.titles.forEach(title => {
                html += `<div class="modal-item" style="margin-left: 20px;">‚Ä¢ ${title}</div>`;
            });
        }
        if (person.activities && person.activities.length) {
            html += '<div class="modal-item"><strong>Activit√©s:</strong></div>';
            person.activities.forEach(activity => {
                html += `<div class="modal-item" style="margin-left: 20px;">‚Ä¢ ${activity}</div>`;
            });
        }
        html += '</div>';
    }
    
    // Distinctions
    if (person.awards || person.succession || person.status) {
        html += '<div class="modal-section">';
        html += '<div class="modal-section-title">üèÜ Distinctions</div>';
        if (person.awards && person.awards.length) {
            person.awards.forEach(award => {
                html += `<div class="modal-item">‚Ä¢ ${award}</div>`;
            });
        }
        if (person.succession) html += `<div class="modal-item"><strong>Succession:</strong> ${person.succession}</div>`;
        if (person.status) html += `<div class="modal-item"><strong>Statut:</strong> ${person.status}</div>`;
        html += '</div>';
    }
    
    // Notes
    if (person.notes) {
        html += '<div class="modal-section">';
        html += '<div class="modal-section-title">üí≠ Notes</div>';
        html += `<div class="modal-item">${person.notes}</div>`;
        html += '</div>';
    }
    
    document.getElementById('modalBody').innerHTML = html;
    document.getElementById('personModal').classList.add('active');
}

// Close modal
function closeModal() {
    document.getElementById('personModal').classList.remove('active');
}

// Filter cards
function filterCards(section) {
    const searchId = section === 'overview' ? 'searchOverview' : 'searchPeople';
    const cardsId = section === 'overview' ? 'overviewCards' : 'peopleCards';
    
    const searchTerm = document.getElementById(searchId).value.toLowerCase();
    const cards = document.querySelectorAll(`#${cardsId} .card`);
    
    cards.forEach(card => {
        const text = card.textContent.toLowerCase();
        if (text.includes(searchTerm)) {
            card.style.display = 'block';
            card.style.opacity = '1';
        } else {
            card.style.opacity = '0.3';
        }
    });
}

// Close modal on Escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeModal();
    }
});

// Initialize on page load
window.addEventListener('DOMContentLoaded', loadData);
</script>

</body>
</html>
